/**
 * Tests for Adaptive Block components
 */

import { describe, expect, test } from "vitest";

import type { BlockResponse } from "../src";

import { Block } from "../src";

describe("Block Components", () => {
  test("Block.Heading with children", () => {
    const heading = Block.Heading({ children: "Test Heading" });
    expect(heading.$type).toBe("Block.Heading");

    const response: BlockResponse = {
      content: Block.Document({ children: heading }),
    };
    expect(response).toEqual({
      content: {
        $type: "Block.Document",
        children: { $type: "Block.Heading", children: "Test Heading" },
      },
    });
  });

  test("Block.Text with children", () => {
    const text = Block.Text({ children: "Test text content" });
    expect(text.$type).toBe("Block.Text");

    const response: BlockResponse = {
      content: Block.Document({ children: text }),
    };
    expect(response).toEqual({
      content: {
        $type: "Block.Document",
        children: { $type: "Block.Text", children: "Test text content" },
      },
    });
  });

  test("Block.Heading with additional properties", () => {
    const heading = Block.Heading({
      children: "Styled Heading",
      fontSize: "md",
      fontWeight: "600",
      level: "2",
    });

    const response: BlockResponse = {
      content: Block.Document({ children: heading }),
    };
    expect(response).toEqual({
      content: {
        $type: "Block.Document",
        children: {
          $type: "Block.Heading",
          children: "Styled Heading",
          fontSize: "md",
          fontWeight: "600",
          level: "2",
        },
      },
    });
  });

  test("Block.Group with children array", () => {
    const group = Block.Group({
      children: [
        Block.Text({ children: "First item" }),
        Block.Text({ children: "Second item" }),
      ],
      flexDirection: "column",
      gap: "16",
    });

    const response: BlockResponse = {
      content: Block.Document({ children: group }),
    };
    expect(response).toEqual({
      content: {
        $type: "Block.Document",
        children: {
          $type: "Block.Group",
          children: [
            { $type: "Block.Text", children: "First item" },
            { $type: "Block.Text", children: "Second item" },
          ],
          flexDirection: "column",
          gap: "16",
        },
      },
    });
  });

  test("Block.Document", () => {
    const doc = Block.Document({
      children: [
        Block.Heading({ children: "Title", level: "2" }),
        Block.Text({ children: "Description" }),
      ],
    });

    const response: BlockResponse = { content: doc };
    expect(response).toEqual({
      content: {
        $type: "Block.Document",
        children: [
          { $type: "Block.Heading", children: "Title", level: "2" },
          { $type: "Block.Text", children: "Description" },
        ],
      },
    });
  });
});
